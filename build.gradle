// Top-level build file where you can add configuration options common to all sub-projects/modules.

buildscript {
    ext.versions = [
        kotlin : [
            stdlib: '1.4.0',
            coroutines: '1.3.9'
        ],
        androidx : [
            core : '1.5.0-alpha02',
            annotation : '1.2.0-alpha01',
            appcompat : '1.3.0-alpha02',
            compose : '1.0.0-alpha06',
            fragment : '1.3.0-alpha08',
            lifecycle : '2.3.0-alpha07',
            savedstate: '1.1.0-alpha01',
            media: '1.2.0-beta01',
            hilt : '1.0.0-alpha02',
        ],
        dagger : [
            core : '2.28.3',
            hilt : '2.28.3-alpha',
        ],
        exoplayer : [
            core : '2.11.7',
        ],
        difference : '1.0.0',
        test : [
            junit : '4.12',
            espresso : '3.2.0',
        ]
    ]

    repositories {
        google()
        jcenter()
        maven { url "https://plugins.gradle.org/m2/" }
    }

    dependencies {
        classpath 'com.android.tools.build:gradle:7.0.0-alpha03'
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${versions.kotlin.stdlib}"
        classpath "org.jlleitschuh.gradle:ktlint-gradle:9.4.1"
        classpath "com.google.dagger:hilt-android-gradle-plugin:${versions.dagger.core}-alpha"
        // NOTE: Do not place your application dependencies here; they belong
        // in the individual module build.gradle files
    }
}

ext {
    targetSdkVersion = 29
    compileSdkVersion = 29
    encoreMinSdkVersion = 16
    jockeyMinSdkVersion = 21

    deps = [
        kotlin : [
            stdlib : "org.jetbrains.kotlin:kotlin-stdlib:${versions.kotlin.stdlib}",
            coroutines : "org.jetbrains.kotlinx:kotlinx-coroutines-core:${versions.kotlin.coroutines}",
        ],
        androidx : [
            core : "androidx.core:core-ktx:${versions.androidx.core}",
            annotation : "androidx.annotation:annotation:${versions.androidx.annotation}",
            appcompat : "androidx.appcompat:appcompat:${versions.androidx.appcompat}",
            fragment : "androidx.fragment:fragment:${versions.androidx.fragment}",
            lifecycle: "androidx.lifecycle:lifecycle-common-java8:${versions.androidx.lifecycle}",
            viewmodel: "androidx.lifecycle:lifecycle-viewmodel-ktx:${versions.androidx.lifecycle}",
            livedata: "androidx.lifecycle:lifecycle-livedata-ktx:${versions.androidx.lifecycle}",
            savedstate: "androidx.lifecycle:lifecycle-viewmodel-savedstate:${versions.androidx.savedstate}",
            media : "androidx.media:media:${versions.androidx.media}",
            hiltViewModel : "androidx.hilt:hilt-lifecycle-viewmodel:${versions.androidx.hilt}",
            hiltCompiler : "androidx.hilt:hilt-compiler:${versions.androidx.hilt}",
        ],
        compose : [
            tooling : "androidx.ui:ui-tooling:${versions.androidx.compose}",
            layout : "androidx.compose.foundation:foundation-layout:${versions.androidx.compose}",
            foundation : "androidx.compose.foundation:foundation:${versions.androidx.compose}",
            material : "androidx.compose.material:material:${versions.androidx.compose}",
        ],
        exoplayer : [
            core : "com.google.android.exoplayer:exoplayer-core:${versions.exoplayer.core}",
            mediasession : "com.google.android.exoplayer:extension-mediasession:${versions.exoplayer.core}"
        ],
        dagger : [
            core : "com.google.dagger:dagger:${versions.dagger.core}",
            compiler : "com.google.dagger:dagger-compiler:${versions.dagger.core}",
            hilt : "com.google.dagger:hilt-android:${versions.dagger.core}-alpha",
            hiltCompiler : "com.google.dagger:hilt-android-compiler:${versions.dagger.core}-alpha",
        ],
        difference : [
            multiplatform : "dev.andrewbailey.difference:difference:${versions.difference}"
        ],
        test : [
            junit : "junit:junit:${versions.test.junit}",
            espresso : "androidx.test.espresso:espresso-core:${versions.test.espresso}",
            kotlinTest : "org.jetbrains.kotlin:kotlin-test:${versions.kotlin.stdlib}",
            kotlinJunit : "org.jetbrains.kotlin:kotlin-test-junit:${versions.kotlin.stdlib}",
            coroutinesTest : "org.jetbrains.kotlinx:kotlinx-coroutines-test:${versions.kotlin.coroutines}",
        ]
    ]
}


allprojects {
    apply plugin: "org.jlleitschuh.gradle.ktlint"

    repositories {
        google()
        jcenter()
        maven { url 'https://dl.bintray.com/kotlin/kotlin-eap' }
    }

    ktlint {
        android = true
        verbose = true
        disabledRules = [
            "no-empty-class-body",
            "no-blank-line-before-rbrace",
        ]
    }

    tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).configureEach {
        kotlinOptions {
            freeCompilerArgs += ["-Xopt-in=kotlin.RequiresOptIn"]
        }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
